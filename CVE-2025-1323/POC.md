# WP-Recall Plugin SQL Injection Exploit (CVE-2025-1323)

## Vulnerability Overview

The WP-Recall plugin for WordPress contains a SQL injection vulnerability in the chat functionality's `last_activity` parameter. 
The vulnerability exists due to improper sanitization of user input before inclusion in SQL queries, allowing attackers to execute arbitrary database commands.

### Vulnerability Location & Technical Analysis
```php
// Vulnerable code in WP-Recall plugin
$last_activity = $_POST['last_activity']; // User input directly used
$sql = "SELECT * FROM wp_rcl_chat_messages WHERE time > '$last_activity'";
```
### Vulnerability Classification
This vulnerability relates to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'), 
where user-controlled input is directly concatenated into SQL queries without proper parameterization.

### Research Background
Based on analysis of WordPress plugin security patterns and SQL injection vulnerabilities:

WordPress Security Team: "Prepared Statements and Data Validation"

OWASP: "SQL Injection Prevention Cheat Sheet"

### Key Insight

The rcl_beat AJAX action processes user-controlled last_activity parameter without proper sanitization.
The parameter is embedded in a JSON structure within the databeat parameter, which is then used in SQL queries without parameterization.

### Request Analysis
Initial observations when monitoring WP-Recall plugin requests:

## Exploitation Methodology

The exploit operates by constructing a malicious payload that is embedded within a JSON structure designed to match the WP-Recall plugin's expected data format. The `encode_databeat_payload` function generates a properly structured data object that the plugin recognizes, but strategically inserts the SQL injection payload into the vulnerable `last_activity` parameter field. This JSON payload is then URL-encoded to ensure proper transmission and sent as part of a POST request to the target endpoint.

The `send_payload` function manages the HTTP communication, configuring appropriate headers to simulate legitimate browser traffic and delivering the crafted malicious payload to the vulnerable AJAX endpoint.

## Exploit Configuration

The primary execution sequence begins by prompting the user for two essential pieces of information: the target WordPress administration URL and the required `ajax_nonce` authentication value. The script then dispatches a test SQL injection payload (`'; SELECT user(); --`) engineered to execute the database's `user()` function while properly commenting out the remainder of the original SQL query. The application displays the server's complete response, which will contain the results of the SQL query execution if the injection attempt proves successful.

This methodological approach effectively demonstrates the vulnerability's mechanics while maintaining clean documentation by referencing external code files, providing clear theoretical understanding of the attack vector without cluttering the documentation with extensive code listings.

### Trigger Exploitation
```
# Run the exploit script
python CVE-2025-1323.py


# Example output:
Enter target URL (e.g. https://target.com/wp-admin/admin-ajax.php): https://vulnerable-site.com/wp-admin/admin-ajax.php
Enter ajax_nonce value: 37c11b0c06

[*] Sending payload: '; SELECT user(); --

[+] Response received:
{"success":true,"data":"database_user@localhost"}
```
