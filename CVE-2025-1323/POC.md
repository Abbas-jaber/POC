# WP-Recall Plugin SQL Injection Exploit (CVE-2025-1323)

## Vulnerability Overview

The WP-Recall plugin for WordPress contains a SQL injection vulnerability in the chat functionality's `last_activity` parameter. 
The vulnerability exists due to improper sanitization of user input before inclusion in SQL queries, allowing attackers to execute arbitrary database commands.

### Vulnerability Location & Technical Analysis
```php
// Vulnerable code in WP-Recall plugin
$last_activity = $_POST['last_activity']; // User input directly used
$sql = "SELECT * FROM wp_rcl_chat_messages WHERE time > '$last_activity'";
```
### Vulnerability Classification
This vulnerability relates to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'), 
where user-controlled input is directly concatenated into SQL queries without proper parameterization.

### Research Background
Based on analysis of WordPress plugin security patterns and SQL injection vulnerabilities:

WordPress Security Team: "Prepared Statements and Data Validation"

OWASP: "SQL Injection Prevention Cheat Sheet"

### Key Insight

```The rcl_beat AJAX action processes user-controlled last_activity parameter without proper sanitization.
The parameter is embedded in a JSON structure within the databeat parameter, which is then used in SQL queries without parameterization.
```
### Request Analysis
Initial observations when monitoring WP-Recall plugin requests:

<img width="1024" height="589" alt="WP-Recall AJAX Request" src="https://github.com/user-attachments/assets/12affe8c-e75c-4852-a489-70fad29655ac" />
